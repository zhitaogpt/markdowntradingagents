# TradingAgents 2.0 设计规范与路线图

## 1. 当前架构 (MVP 状态)
*   **核心**: 基于文件系统的状态管理 (`agency/data`, `agency/reports`)。
*   **编排器**: Bash 脚本 (`orchestrator.sh`) 管理线性工作流。
*   **数据**: 混合管道 (Finnhub 获取实时价/基本面 + Stooq 获取历史 K 线)。
*   **Agent**: 4 名分析师 (技术、基本面、舆情、宏观) + 2 名研究员 (多方、空方) + 1 名决策者 (基金经理)。

## 2. 局限性分析 (v0.1)

### 2.1 数据层
*   **粒度**: 仅限日线，缺失日内波动细节。
*   **深度**: 新闻仅抓取标题，Agent 无法阅读正文摘要。

### 2.2 认知层
*   **交互**: 线性辩论（多空双方没有直接交锋）。
*   **记忆**: 无状态。不记得对同一标的历史上的分析结论。

### 2.3 鲁棒性
*   **编排**: Bash 脚本在处理复杂的错误处理和条件逻辑时较为脆弱。

## 3. 开发路线图

### 第一阶段：Prompt 工程优化 (当前重点) 🧠
*   **目标**: 在不改动代码的情况下，极大提升分析深度。
*   **行动**:
    *   **技术分析 Agent**: 强制要求识别 K 线形态（如双底、头肩顶）。
    *   **基本面 Agent**: 增加定性分析（护城河、管理层、资本配置）。
    *   **辩论环节**: 强制要求“数据说话”，引用具体指标攻击对方。

### 第二阶段：Python 编排重构 (重构) 🐍
*   **目标**: 提升稳定性和实现复杂流。
*   **行动**:
    *   将 `orchestrator.sh` 迁移至 `agency_manager.py`。
    *   实现子进程管理和 JSON 校验。

### 第三阶段：数据深度挖掘 📊
*   **目标**: 日内数据与全文阅读。
*   **行动**:
    *   集成 **Twelve Data** (获取 15min/1h K 线)。
    *   增加网页抓取逻辑，阅读新闻全文。

### 第四阶段：记忆与可视化 🖼️
*   **目标**: 上下文关联与视觉增强。
*   **行动**:
    *   **向量记忆**: 将历史裁决存储在 Markdown 存档中。
    *   **图表生成**: 使用 Matplotlib 生成 K 线图并嵌入研报。

## 4. Prompt 增强计划 (立即实施)
从“指令型”转变为“角色驱动 + 框架驱动”。

*   **技术分析**: “不要只列 RSI，告诉我 RSI 背离意味着什么。”
*   **基本面**: “不要只列 PE，把 PEG 与行业平均水平对比。”
*   **风险管理**: “计算最坏情况（3-sigma 事件）下的应对方案。”